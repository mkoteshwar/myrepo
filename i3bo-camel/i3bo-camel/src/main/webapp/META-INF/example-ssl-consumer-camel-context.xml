<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:cxf="http://camel.apache.org/schema/cxf"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://camel.apache.org/schema/cxf http://camel.apache.org/schema/cxf/camel-cxf.xsd
        http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <bean id="properties" class="org.apache.camel.component.properties.PropertiesComponent">
        <property name="location" value="file:${env:JBOSS_HOME}/standalone/configuration/environment.properties" />
    </bean>

    <sslContextParameters id="sslContextParams"
        xmlns="http://camel.apache.org/schema/spring">
		<serverParameters clientAuthentication="REQUIRE" />
		<trustManagers>
			<keyStore resource="{{truststorefile}}" password="{{truststorefile.password}}" />
		</trustManagers> 
        <keyManagers keyPassword="{{privatekey.password}}">
            <keyStore resource="{{jksfile}}" password="{{jksfile.password}}" />
        </keyManagers>
    </sslContextParameters>

    <camelContext id="example-ssl-consumer-camel-context" xmlns="http://camel.apache.org/schema/spring" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:urn="urn:l1id.com:ImageServer" xmlns:urn1="urn:digimarc.com:imaging" xmlns:urn2="urn:digimarc.com:SchemaTypes">
	<!--<restConfiguration component="undertow" contextPath="/camel-sample-rest/rest"/>-->
        <restConfiguration component="jetty" contextPath="/camel-sample-rest/rest" port="25001" scheme="https">
        	<endpointProperty key="sslContextParameters" value="#sslContextParams"></endpointProperty>
        </restConfiguration>
        <rest path="/say">
   			<get uri="/hello" produces="text/plain">
      			<to uri="direct:hello"/>
    		</get>
    	</rest>
    	<rest path="/example" produces="text/plain">
    		<get uri="/ssl">
    			<to uri="direct:ssl"/>
    		</get>
    	</rest>
    	<route>
    		<from uri="direct:hello"/>
    		<transform>
      			<constant>Hello REST World</constant>
    		</transform>
    	</route>     
        <route streamCache="true">
            <!-- <from uri="jetty:https://0.0.0.0:25001/example/ssl?sslContextParameters=#sslContextParams&amp;matchOnUriPrefix=true"/> -->
            <from uri="direct:ssl"/>
            <transform>
                <constant>SSL is working!</constant>
            </transform>
        </route>
        
    </camelContext>
</beans>